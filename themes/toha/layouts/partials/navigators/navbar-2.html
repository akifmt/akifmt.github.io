{{/* by default, don't use any logo */}}
{{ $mainLogo := "" }}
{{ $invertedLogo := "" }}

{{/*  if custom logo has been provided, use them  */}}
{{ if site.Params.logo.main }}
  {{ $mainLogo = site.Params.logo.main }}
{{ end }}
{{ if site.Params.logo.inverted }}
  {{ $invertedLogo = site.Params.logo.inverted }}
{{ end }}

{{/* resize the logos. don't resize svg because it is not supported */}}
{{ if $mainLogo }}
  {{ $mainLogo = resources.Get $mainLogo}}
  {{ if and $mainLogo (ne $mainLogo.MediaType.SubType "svg") }}
    {{ $mainLogo = $mainLogo.Resize "42x" }}
  {{ end }}
  {{ $mainLogo = $mainLogo.RelPermalink}}
{{ end }}

{{ if $invertedLogo }}
  {{ $invertedLogo = resources.Get $invertedLogo}}
  {{ if and $invertedLogo (ne $invertedLogo.MediaType.SubType "svg")}}
    {{ $invertedLogo = $invertedLogo.Resize "42x" }}
  {{ end }}
  {{ $invertedLogo = $invertedLogo.RelPermalink}}
{{ end }}


{{/*  variables for enabling/disabling various features  */}}
{{ $blogEnabled   := site.Params.features.blog.enable   | default false }}
{{ $notesEnabled  := site.Params.features.notes.enable  | default false }}

{{/*  keep backward compatibility for blog post  */}}
{{ if site.Params.enableBlogPost }}
  {{ $blogEnabled = true }}
{{ end }}

{{ $customMenus := site.Params.customMenus }}
{{ if (index site.Data site.Language.Lang).site.customMenus }}
  {{ $customMenus = (index site.Data site.Language.Lang).site.customMenus }}
{{ end }}

<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="{{ site.BaseURL | relLangURL }}">
      {{ if $mainLogo }}
        <img src="{{ $mainLogo  }}" alt="Logo">
      {{ end }}
      {{- site.Title -}}
    </a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>


	<div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
	  {{ if $blogEnabled }}
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="{{ "/posts/" | relLangURL }}">{{ i18n "posts" }}</a>
          </li>
        {{ end }}
        {{ if $notesEnabled }}
		  <li class="nav-item">
            <a class="nav-link" id="note-link" href="{{ "/notes/" | relLangURL }}">{{ i18n "notes" }}</a>
		  </li>
        {{ end }}
		{{ range $customMenus }}
            {{ if (not .hideFromNavbar) }}
              <li class="nav-item">
                <a class="nav-link" href="{{ .url }}"><img height="20" src="{{ .preimage }}" /> {{ .name }}</a>
              </li>
            {{ end }}
        {{ end }}
		{{ $shouldAddSeparator:= partial "helpers/add-navbar-separator.html" . }}
        {{ if $shouldAddSeparator }}
          <div class="dropdown-divider" id="top-navbar-divider"></div>
        {{ end }}
      {{ if .IsTranslated }}
        {{ partial "navigators/lang-selector-2.html" . }}
      {{ end }}
      {{ if site.Params.darkMode.enable }}
        {{ partial "navigators/theme-selector.html" . }}
      {{ end }}
      </ul>
    </div>
	
  </div>
  <!-- Store the logo information in a hidden img for the JS -->
  {{ if $mainLogo }}
    <img src="{{ $mainLogo }}" class="d-none" id="main-logo" alt="Logo">
  {{ end }}
  {{ if $invertedLogo }}
    <img src="{{ $invertedLogo }}" class="d-none" id="inverted-logo" alt="Inverted Logo">
  {{ end }}
</nav>
