<!doctype html><html lang=en><head><title>Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-S9QF79W9GM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("consent","default",{ad_user_data:"denied",ad_personalization:"denied",ad_storage:"denied",analytics_storage:"denied",wait_for_update:500}),gtag("js",new Date),gtag("config","G-S9QF79W9GM")</script><link rel=stylesheet href=/application.0d9012d65f65702682bcef2365fb9eef7e7694262d61d4e7c0619a37e89c8519.css integrity="sha256-DZAS1l9lcCaCvO8jZfue7352lCYtYdTnwGGaN+ichRk="><link rel=stylesheet href=/css/main_custom.css><link rel=icon type=image/png href=/images/site/favicon_hu5e0469842f323d92977e05301135eda0_41440_42x0_resize_box_3.png><meta property="og:title" content="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server"><meta property="og:description" content="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server"><meta property="og:type" content="article"><meta property="og:url" content="https://akifmt.github.io/dotnet/2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server/"><meta property="article:section" content="dotnet"><meta property="article:published_time" content="2024-03-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server"><meta name=twitter:description content="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server"><meta name=description content="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server"><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-78150589-1","auto"),ga("send","pageview"))</script><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-dotnet kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu9e97de834330d7f5d59d0d943d25df7c_18556_42x0_resize_box_3.png id=logo alt=Logo>
akifmt</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#recent-posts-dotnet>Recent Dotnet Posts</a>
<a class=dropdown-item href=/#recent-posts>Recent Posts</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link href=/dotnet/><img height=20 src=/images/dotnet-logo.png>
dotnet Blog</a></li><li class=nav-item><a class=nav-link href=/contacts/contact/>Contact</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu9e97de834330d7f5d59d0d943d25df7c_18556_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_huaeac6b74eff06a7b4d6b563d4aa0a06e_40468_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading>dotnet<a href=/dotnet/ data-filter=all></a></li><div class=subtree><li><a class=list-link href=/dotnet/2000-01-01-all-dotnet-posts/ title="All Posts">All Posts</a></li><li><a class=list-link href=/dotnet/2025-07-20-blazor-radzen-.net8-datagrid-incelledit/ title="Blazor Radzen .NET 8 DataGrid InCellEdit">Blazor Radzen .NET 8 DataGrid InCellEdit</a></li><li><a class=list-link href=/dotnet/2025-07-05-blazor-radzen-.net8-datagrid-inlineedit/ title="Blazor Radzen .NET 8 DataGrid InLineEdit">Blazor Radzen .NET 8 DataGrid InLineEdit</a></li><li><a class=list-link href=/dotnet/2025-06-01-blazor-radzen-.net8-menu-with-adaptive-behavior-for-mobile-and-desktop/ title="Blazor Radzen .NET 8 Menu with Adaptive Behavior for Mobile and Desktop">Blazor Radzen .NET 8 Menu with Adaptive Behavior for Mobile and Desktop</a></li><li><a class=list-link href=/dotnet/2025-02-02-new-features-.net9-and-csharp13-what-developers-need-to-know/ title="New Features .NET 9 and C# 13 What Developers Need to Know">New Features .NET 9 and C# 13 What Developers Need to Know</a></li><li><a class=list-link href=/dotnet/2024-08-11-blazor-radzen-.net8-upgrade-radzen-4-to-5/ title="Blazor Radzen .NET 8 Upgrade Radzen 4 to 5">Blazor Radzen .NET 8 Upgrade Radzen 4 to 5</a></li><li><a class=list-link href=/dotnet/2024-08-10-blazor-radzen-.net8-role-based-authorization-with-identity/ title="Blazor Radzen .NET 8 Role-based Authorization with Identity">Blazor Radzen .NET 8 Role-based Authorization with Identity</a></li><li><a class=list-link href=/dotnet/2024-08-03-blazor-radzen-.net8-identity-automatically-logout-timer/ title="Blazor Radzen .NET 8 Identity Automatically Logout Timer">Blazor Radzen .NET 8 Identity Automatically Logout Timer</a></li><li><a class=list-link href=/dotnet/2024-07-28-blazor-radzen-.net8-authenticationauthorization-with-identity/ title="Blazor Radzen .NET 8 Authentication & Authorization with Identity">Blazor Radzen .NET 8 Authentication & Authorization with Identity</a></li><li><a class=list-link href=/dotnet/2024-06-08-blazor-radzen-.net8-google-maps/ title="Blazor Radzen .NET 8 Google Maps">Blazor Radzen .NET 8 Google Maps</a></li><li><a class=list-link href=/dotnet/2024-05-29-blazor-radzen-.net8-serilog-logging/ title="Blazor Radzen .NET 8 Serilog Logging to Console, File and Database">Blazor Radzen .NET 8 Serilog Logging to Console, File and Database</a></li><li><a class=list-link href=/dotnet/2024-05-15-blazor-radzen-.net8-htmleditor/ title="Blazor Radzen .NET 8 Html Editor">Blazor Radzen .NET 8 Html Editor</a></li><li><a class=list-link href=/dotnet/2024-05-04-blazor-radzen-.net8-multiple-themes-dark-and-light-mode/ title="Blazor Radzen .NET 8 Multiple Themes Dark and Light Mode">Blazor Radzen .NET 8 Multiple Themes Dark and Light Mode</a></li><li><a class=list-link href=/dotnet/2024-04-16-blazor-.net8-autocompile-sass-and-less/ title="Blazor .NET 8 Autocompile Sass and Less">Blazor .NET 8 Autocompile Sass and Less</a></li><li><a class=list-link href=/dotnet/2024-04-05-blazor-.net8-microservices-2-blazor-client-ocelot-gateway-and-securing-api-with-duende-identity-server/ title="Blazor .NET 8 Microservices 2 Blazor Client Ocelot Gateway and Securing API with Duende Identity Server">Blazor .NET 8 Microservices 2 Blazor Client Ocelot Gateway and Securing API with Duende Identity Server</a></li><li><a class="active list-link" href=/dotnet/2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server/ title="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server">Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</a></li><li><a class=list-link href=/dotnet/2024-02-12-blazor-.net8-and-minimal-apis-native-aot-crud/ title="Blazor .NET 8 and Minimal APIs Native AOT CRUD">Blazor .NET 8 and Minimal APIs Native AOT CRUD</a></li><li><a class=list-link href=/dotnet/2024-02-09-blazor-.net8-object-mapping-with-automapper/ title="Blazor .NET 8 Object Mapping with AutoMapper">Blazor .NET 8 Object Mapping with AutoMapper</a></li><li><a class=list-link href=/dotnet/2024-01-24-blazor-.net8-object-mapping-with-mapster/ title="Blazor .NET 8 Object Mapping with Mapster">Blazor .NET 8 Object Mapping with Mapster</a></li><li><a class=list-link href=/dotnet/2024-01-20-blazor-.net8-migrating-app-from-.net-6-or-.net-7-to-.net-8/ title="Blazor .NET 8 Migrating app from .NET 6 or .NET 7 to .NET 8">Blazor .NET 8 Migrating app from .NET 6 or .NET 7 to .NET 8</a></li><li><a class=list-link href=/dotnet/2024-01-16-blazor-.net8-server-side-rendering-ssr/ title="Blazor .NET 8 Server-side Rendering (SSR)">Blazor .NET 8 Server-side Rendering (SSR)</a></li><li><a class=list-link href=/dotnet/2024-01-13-blazor-.net8-hosting-models/ title="Blazor .NET 8 Hosting Models">Blazor .NET 8 Hosting Models</a></li><li><a class=list-link href=/dotnet/2023-10-16-blazor-infinite-scrolling/ title="Blazor Infinite Scrolling">Blazor Infinite Scrolling</a></li><li><a class=list-link href=/dotnet/2023-09-26-blazor-export-data-to-word-excel-pdf-csv/ title="Blazor Export Data to Word, Excel, PDF, CSV">Blazor Export Data to Word, Excel, PDF, CSV</a></li><li><a class=list-link href=/dotnet/2023-09-21-blazor-external-login-identity-provider/ title="Blazor External Login Identity Provider Google, Facebook, Microsoft, Twitter">Blazor External Login Identity Provider Google, Facebook, Microsoft, Twitter</a></li><li><a class=list-link href=/dotnet/2023-09-10-blazor-radzen-loading-on-page/ title="Blazor Radzen Loading on Page">Blazor Radzen Loading on Page</a></li><li><a class=list-link href=/dotnet/2023-09-03-blazor-send-email-with-mailkit/ title="Blazor Send Email with MailKit">Blazor Send Email with MailKit</a></li><li><a class=list-link href=/dotnet/2023-08-30-blazor-redis-as-backplane/ title="Blazor Redis as Backplane">Blazor Redis as Backplane</a></li><li><a class=list-link href=/dotnet/2023-08-25-blazor-resize-and-upload-images/ title="Blazor Resize and Upload Images">Blazor Resize and Upload Images</a></li><li><a class=list-link href=/dotnet/2023-08-18-blazor-scheduling-with-quartz.net/ title="Blazor Scheduling with Quartz.NET">Blazor Scheduling with Quartz.NET</a></li><li><a class=list-link href=/dotnet/2023-08-15-blazor-serilog-logging/ title="Blazor Serilog Logging to Console, File and Database">Blazor Serilog Logging to Console, File and Database</a></li><li><a class=list-link href=/dotnet/2023-08-13-blazor-implementing-google-recaptcha-v2/ title="Blazor Implementing Google reCAPTCHA v2">Blazor Implementing Google reCAPTCHA v2</a></li><li><a class=list-link href=/dotnet/2023-08-11-blazor-implementing-google-recaptcha-v3/ title="Blazor Implementing Google reCAPTCHA v3">Blazor Implementing Google reCAPTCHA v3</a></li><li><a class=list-link href=/dotnet/2023-08-09-blazor-radzen-globalization-and-localization/ title="Blazor Radzen Globalization and Localization">Blazor Radzen Globalization and Localization</a></li><li><a class=list-link href=/dotnet/2023-08-07-blazor-using-npm-packages/ title="Blazor Using NPM Packages">Blazor Using NPM Packages</a></li><li><a class=list-link href=/dotnet/2023-08-05-blazor-generic-components/ title="Blazor Generic Components">Blazor Generic Components</a></li><li><a class=list-link href=/dotnet/2023-08-02-blazor-rssfeed/ title="Blazor Expose a Feed as RSS">Blazor Expose a Feed as RSS</a></li><li><a class=list-link href=/dotnet/2023-07-31-blazor-ef-multipledbproviders/ title="Blazor EF Migrations with Multiple Providers">Blazor EF Migrations with Multiple Providers</a></li><li><a class=list-link href=/dotnet/2023-07-30-blazor-authentication-authorization/ title="Blazor Authentication and Authorization">Blazor Authentication and Authorization</a></li><li><a class=list-link href=/dotnet/2023-07-26-blazor-radzen-crud/ title="Blazor Radzen CRUD">Blazor Radzen CRUD</a></li><li><a class=list-link href=/dotnet/2023-07-21-blazor-radzen-searchcomponent/ title="Blazor Radzen SearchComponent">Blazor Radzen SearchComponent</a></li><li><a class=list-link href=/dotnet/2023-07-20-blazor-plyr-video-player/ title="Blazor Plyr Video Player">Blazor Plyr Video Player</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/dotnet/2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server/blazor_dotnet8.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/akif_hu0b098ee5eab0ebaed64b2691fffe1073_4640_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Akif T.</h5><p class=text-muted>Friday, March 15, 2024 | 11 minutes</p></div><div class=title><h1>Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/dotnet8/ class="btn btn-sm btn-info">dotnet8</a></li><li class=rounded><a href=/tags/.net8/ class="btn btn-sm btn-info">.NET8</a></li><li class=rounded><a href=/tags/blazor/ class="btn btn-sm btn-info">Blazor</a></li><li class=rounded><a href=/tags/microservices-blazor-client-and-securing-api-with-duende-identity-server/ class="btn btn-sm btn-info">Microservices Blazor Client and Securing API with Duende Identity Server</a></li></ul></div><div class=post-content id=post-content><p class="d-flex justify-content-center"><img src=blazor_dotnet8.jpg alt=blazor_dotnet8 title=blazor_dotnet8 style=border-radius:20px><br><p><h4 id=blazor-net-8-microservices-blazor-client-and-securing-api-with-duende-identity-server><strong>Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</strong></h4><p>A Blazor .NET 8 microservices client application and integrates it with Duende Identity Server for securing the API endpoints. The code demonstrates the configuration of services, authentication, authorization, and HTTP request pipeline setup.</p><p>Blazor: <code>Blazor</code> is a framework for building interactive web UIs using C# instead of JavaScript. It allows developers to create web applications using .NET and C#.</p><p>.NET 8: <code>.NET 8</code> is a version of the .NET framework that provides a platform for building various types of applications, including web, desktop, and mobile applications.</p><p>Microservices: <code>Microservices</code> architecture involves breaking down an application into <code>smaller</code>, <code>independent services</code> that can be <code>developed</code>, <code>deployed</code>, and <code>scaled</code> independently.</p><p>Securing API: <code>Securing APIs</code> involves implementing <code>authentication</code> and <code>authorization</code> mechanisms to control access to API endpoints.</p><p>Identity Server: <code>Identity Server</code> is an <code>open-source</code> identity and access control solution for .NET applications. <code>Duende Identity Server</code> is a fork of Identity Server with additional features and improvements.</p><p>API Controller: An <code>API controller</code> is a class in a web application that handles <code>HTTP requests</code> and returns HTTP responses. It contains methods (also known as actions) that correspond to different HTTP verbs (<code>GET, POST, PUT, DELETE</code>) and perform specific operations.</p><hr><h5 id=projects><strong>Projects</strong></h5><table><thead><tr><th>Project Name</th><th>Port</th><th>Template</th></tr></thead><tbody><tr><td>Microser.IdS</td><td>:5001</td><td>Duende IdentityServer with Entity Framework Stores (Duende Software)</td></tr><tr><td>Microser.API.Weather</td><td>:6001</td><td>ASP.NET Core Web API</td></tr><tr><td>Microser.BlazorAppClient</td><td>:7001</td><td>Blazor Web App</td></tr></tbody></table><hr><h5 id=test-users><strong>Test Users</strong></h5><table><thead><tr><th style=text-align:center>Role</th><th style=text-align:center>Username</th><th style=text-align:center>Password</th></tr></thead><tbody><tr><td style=text-align:center><kbd>admin</kbd></td><td style=text-align:center>alice</td><td style=text-align:center>alice</td></tr><tr><td style=text-align:center><kbd>user</kbd></td><td style=text-align:center>bob</td><td style=text-align:center>bob</td></tr></tbody></table><h5 id=microserapiweather---web-api-project><strong>Microser.API.Weather - Web API Project</strong></h5><p>A Blazor .NET 8 <code>Microservices</code> project with <code>authentication and authorization</code> using JWT tokens. By configuring services for <code>controllers</code>, <code>Swagger documentation</code>, <code>authentication</code>, and <code>authorization policies</code>, the application ensures secure access to APIs while enabling efficient development and documentation processes.</p><p><kbd>Program.cs</kbd></p><pre tabindex=0><code>using Microsoft.IdentityModel.Tokens;

internal class Program
{
    private static void Main(string[] args)
    {
        var builder = WebApplication.CreateBuilder(args);

        // Add services to the container.

        builder.Services.AddControllers();
        // Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle
        builder.Services.AddEndpointsApiExplorer();
        builder.Services.AddSwaggerGen();

        builder.Services.AddAuthentication(&#34;Bearer&#34;)
            .AddJwtBearer(&#34;Bearer&#34;, options =&gt;
            {
                options.Authority = &#34;https://localhost:5001&#34;;
                options.TokenValidationParameters = new TokenValidationParameters
                {
                    ValidateAudience = false
                };
            });

        builder.Services.AddAuthorization(options =&gt;
        {
            options.AddPolicy(&#34;ClientIdPolicy&#34;, policy =&gt; policy.RequireClaim(&#34;client_id&#34;, &#34;microser_api_weather&#34;, &#34;dotnet_blazor_serverapp&#34;));
        });

        var app = builder.Build();

        // Configure the HTTP request pipeline.
        if (app.Environment.IsDevelopment())
        {
            app.UseSwagger();
            app.UseSwaggerUI();
        }

        app.UseHttpsRedirection();

        app.UseAuthentication();

        app.UseAuthorization();

        app.MapControllers();

        app.Run();
    }
}
</code></pre><p>Initializes a <code>WebApplication builder</code>, adds necessary services like <code>controllers</code>, <code>Swagger</code>, <code>authentication</code>, and <code>authorization</code>. It configures <code>JWT bearer</code> authentication with <code>Duende Identity Server</code>, sets up <code>authorization policies</code>, and defines the <code>request</code> pipeline. In development mode, it enables Swagger UI for API testing.</p><p><kbd>WeatherForecastController.cs</kbd></p><pre tabindex=0><code>using Microser.Core.Models;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.Mvc;

namespace Microser.API.Weather.Controllers;

[Authorize(Policy = &#34;ClientIdPolicy&#34;)]
[ApiController]
[Route(&#34;[controller]&#34;)]
public class WeatherForecastController : ControllerBase
{
    private readonly ILogger&lt;WeatherForecastController&gt; _logger;

    public WeatherForecastController(ILogger&lt;WeatherForecastController&gt; logger)
    {
        _logger = logger;
    }

    [HttpGet(Name = &#34;GetWeatherForecasts&#34;)]
    public ActionResult&lt;IEnumerable&lt;WeatherForecast&gt;&gt; Get()
    {
        return Ok(Data.WeatherForecasts);
    }

    [HttpGet(&#34;{id}&#34;, Name = &#34;GetWeatherForecast&#34;)]
    public ActionResult&lt;WeatherForecast&gt; Get(int id)
    {
        var item = Data.WeatherForecasts.FirstOrDefault(x =&gt; x.Id == id);
        if (item == null)
            return NotFound();
        return Ok(item);
    }

    [HttpPost(Name = &#34;PostWeatherForecast&#34;)]
    public ActionResult&lt;WeatherForecast&gt; Post(WeatherForecast weatherForecast)
    {
        var last = Data.WeatherForecasts.LastOrDefault();
        if (last == null)
            weatherForecast.Id = 1;
        else
            weatherForecast.Id = last.Id + 1;

        Data.WeatherForecasts.Add(weatherForecast);

        return new CreatedAtRouteResult(&#34;GetWeatherForecast&#34;, new { id = weatherForecast.Id }, weatherForecast);
    }

    [HttpPut(&#34;{id}&#34;, Name = &#34;PutWeatherForecast&#34;)]
    public ActionResult&lt;WeatherForecast&gt; Put(int id, WeatherForecast weatherForecast)
    {
        var item = Data.WeatherForecasts.FirstOrDefault(x =&gt; x.Id == id);
        if (item == null)
            return NotFound();

        item.Date = weatherForecast.Date;
        item.TemperatureC = weatherForecast.TemperatureC;
        item.Summary = weatherForecast.Summary;

        return NoContent();
    }

    [HttpDelete(&#34;{id}&#34;, Name = &#34;DeleteWeatherForecast&#34;)]
    public ActionResult&lt;WeatherForecast&gt; Delete(int id)
    {
        var item = Data.WeatherForecasts.FirstOrDefault(x =&gt; x.Id == id);
        if (item == null)
            return NotFound();

        Data.WeatherForecasts.Remove(item);

        return Ok();
    }
}
</code></pre><p>The <code>WeatherForecastController</code> class is defined within the Microser.API.Weather.Controllers namespace. It is decorated with various attributes that provide additional information and behavior to the controller.</p><p><code>[Authorize(Policy = "ClientIdPolicy")]</code> This attribute specifies that the controller requires authorization based on a policy named <code>"ClientIdPolicy"</code>. It ensures that only authenticated clients with the appropriate policy can access the controller&rsquo;s actions.</p><p><code>[ApiController]</code> This attribute indicates that the class is an API controller. It enables various features and conventions for API controllers, such as automatic model validation and attribute routing.</p><p><code>[Route("[controller]")]</code> This attribute specifies the <code>base route</code> for the controller. In this case, the route is determined by the controller&rsquo;s name, which is <code>"WeatherForecast"</code>. So, the base route for this controller is &ldquo;/WeatherForecast&rdquo;.</p><p>The controller inherits from the <code>ControllerBase</code> class, which provides a base implementation for API controllers in ASP.NET Core.</p><h5 id=microserids---identityserver-project><strong>Microser.IdS - IdentityServer Project</strong></h5><p>Create from template:
<a href=https://github.com/DuendeSoftware/IdentityServer.Templates target=_blank rel=noopener>https://github.com/DuendeSoftware/IdentityServer.Templates</a></p><p>Install with:</p><pre tabindex=0><code>dotnet new install Duende.IdentityServer.Templates
</code></pre><p>Identity Server migrations and seed:</p><pre tabindex=0><code>Microser\Microser.IdS&gt; .\buildschema.bat
Microser\Microser.IdS&gt; dotnet run /seed
</code></pre><p>The <code>HostingExtensions.cs</code> file contains two extension methods: <code>ConfigureServices</code> and <code>ConfigurePipeline</code>. Let&rsquo;s explore each method in detail.</p><p><kbd>HostingExtensions.cs</kbd></p><pre tabindex=0><code>using Duende.IdentityServer;
using Microser.IdS.Pages.Admin.ApiScopes;
using Microser.IdS.Pages.Admin.Clients;
using Microser.IdS.Pages.Admin.IdentityScopes;
using Microsoft.AspNetCore.Mvc.RazorPages;
using Microsoft.EntityFrameworkCore;
using Serilog;

namespace Microser.IdS
{
    internal static class HostingExtensions
    {
        public static WebApplication ConfigureServices(this WebApplicationBuilder builder)
        {
            builder.Services.AddRazorPages();

            var connectionString = builder.Configuration.GetConnectionString(&#34;DefaultConnection&#34;);

            var isBuilder = builder.Services
                .AddIdentityServer(options =&gt;
                {
                    options.Events.RaiseErrorEvents = true;
                    options.Events.RaiseInformationEvents = true;
                    options.Events.RaiseFailureEvents = true;
                    options.Events.RaiseSuccessEvents = true;

                    // see https://docs.duendesoftware.com/identityserver/v5/fundamentals/resources/
                    options.EmitStaticAudienceClaim = true;
                })
                .AddTestUsers(TestUsers.Users)
                // this adds the config data from DB (clients, resources, CORS)
                .AddConfigurationStore(options =&gt;
                {
                    options.ConfigureDbContext = b =&gt;
                        b.UseSqlite(connectionString, dbOpts =&gt; dbOpts.MigrationsAssembly(typeof(Program).Assembly.FullName));
                })
                // this is something you will want in production to reduce load on and requests to the DB
                //.AddConfigurationStoreCache()
                //
                // this adds the operational data from DB (codes, tokens, consents)
                .AddOperationalStore(options =&gt;
                {
                    options.ConfigureDbContext = b =&gt;
                        b.UseSqlite(connectionString, dbOpts =&gt; dbOpts.MigrationsAssembly(typeof(Program).Assembly.FullName));
                });

            builder.Services.AddAuthentication()
                .AddGoogle(options =&gt;
                {
                    options.SignInScheme = IdentityServerConstants.ExternalCookieAuthenticationScheme;

                    // register your IdentityServer with Google at https://console.developers.google.com
                    // enable the Google+ API
                    // set the redirect URI to https://localhost:5001/signin-google
                    options.ClientId = &#34;copy client ID from Google here&#34;;
                    options.ClientSecret = &#34;copy client secret from Google here&#34;;
                });

            // this adds the necessary config for the simple admin/config pages
            {
                builder.Services.AddAuthorization(options =&gt;
                    options.AddPolicy(&#34;admin&#34;,
                        policy =&gt; policy.RequireClaim(&#34;sub&#34;, &#34;1&#34;))
                );

                builder.Services.Configure&lt;RazorPagesOptions&gt;(options =&gt;
                    options.Conventions.AuthorizeFolder(&#34;/Admin&#34;, &#34;admin&#34;));

                builder.Services.AddTransient&lt;Microser.IdS.Pages.Portal.ClientRepository&gt;();
                builder.Services.AddTransient&lt;ClientRepository&gt;();
                builder.Services.AddTransient&lt;IdentityScopeRepository&gt;();
                builder.Services.AddTransient&lt;ApiScopeRepository&gt;();
            }

            // if you want to use server-side sessions: https://blog.duendesoftware.com/posts/20220406_session_management/
            // then enable it
            //isBuilder.AddServerSideSessions();
            //
            // and put some authorization on the admin/management pages using the same policy created above
            //builder.Services.Configure&lt;RazorPagesOptions&gt;(options =&gt;
            //    options.Conventions.AuthorizeFolder(&#34;/ServerSideSessions&#34;, &#34;admin&#34;));

            return builder.Build();
        }

        public static WebApplication ConfigurePipeline(this WebApplication app)
        {
            app.UseSerilogRequestLogging();

            if (app.Environment.IsDevelopment())
            {
                app.UseDeveloperExceptionPage();
            }

            app.UseStaticFiles();
            app.UseRouting();
            app.UseIdentityServer();
            app.UseAuthorization();

            app.MapRazorPages()
                .RequireAuthorization();

            return app;
        }
    }
}
</code></pre><p>The <code>ConfigureServices</code> method is responsible for configuring the <code>services</code> required by the application
The <code>ConfigurePipeline</code> method is responsible for configuring the <code>middleware pipeline</code> of the application.</p><p><kbd>Config.cs</kbd></p><pre tabindex=0><code>using Duende.IdentityServer;
using Duende.IdentityServer.Models;
using IdentityModel;

namespace Microser.IdS
{
    public static class Config
    {
        public static IEnumerable&lt;IdentityResource&gt; IdentityResources =&gt;
            new IdentityResource[]
            {
                new IdentityResources.OpenId(),
                new IdentityResources.Profile(),
                new IdentityResources.Address(),
                new IdentityResources.Email(),
                new IdentityResource(
                        &#34;roles&#34;,
                        &#34;Your role(s)&#34;,
                        new List&lt;string&gt;(){ JwtClaimTypes.Role })
            };

        public static IEnumerable&lt;ApiScope&gt; ApiScopes =&gt;
            new ApiScope[]
            {
                new ApiScope(&#34;scope1&#34;),
                new ApiScope(&#34;scope2&#34;),

                new ApiScope(&#34;microser_api_weather&#34;),
            };

        public static IEnumerable&lt;Client&gt; Clients =&gt;
            new Client[]
            {
                new Client
                {
                    ClientId = &#34;dotnet_blazor_serverapp&#34;,
                    ClientName = &#34;Blazor Server App&#34;,
                    ClientSecrets = {
                        new Secret(&#34;E8C65E41BB0E4E519D409023CF5112F4&#34;.Sha256())
                    },
                    AllowedGrantTypes = GrantTypes.Code,
                    RequirePkce = true,
                    RequireClientSecret = true,
                    AllowedCorsOrigins = { &#34;https://localhost:7001&#34; },
                    AllowedScopes = {
                        IdentityServerConstants.StandardScopes.OpenId,
                        IdentityServerConstants.StandardScopes.Profile,
                        IdentityServerConstants.StandardScopes.Address,
                        IdentityServerConstants.StandardScopes.Email,
                        &#34;roles&#34;,
                        &#34;scope1&#34;,
                        &#34;microser_api_weather&#34;
                    },
                    RedirectUris = { &#34;https://localhost:7001/signin-oidc&#34; },
                    PostLogoutRedirectUris = { &#34;https://localhost:7001/signout-callback-oidc&#34; },
                    Enabled = true
                },

                // m2m client credentials flow client
                new Client
                {
                    ClientId = &#34;m2m.client&#34;,
                    ClientName = &#34;Client Credentials Client&#34;,

                    AllowedGrantTypes = GrantTypes.ClientCredentials,
                    ClientSecrets = { new Secret(&#34;511536EF-F270-4058-80CA-1C89C192F69A&#34;.Sha256()) },

                    AllowedScopes = { &#34;scope1&#34; }
                },

                // interactive client using code flow + pkce
                new Client
                {
                    ClientId = &#34;interactive&#34;,
                    ClientSecrets = { new Secret(&#34;49C1A7E1-0C79-4A89-A3D6-A37998FB86B0&#34;.Sha256()) },

                    AllowedGrantTypes = GrantTypes.Code,

                    RedirectUris = { &#34;https://localhost:44300/signin-oidc&#34; },
                    FrontChannelLogoutUri = &#34;https://localhost:44300/signout-oidc&#34;,
                    PostLogoutRedirectUris = { &#34;https://localhost:44300/signout-callback-oidc&#34; },

                    AllowOfflineAccess = true,
                    AllowedScopes = { &#34;openid&#34;, &#34;profile&#34;, &#34;scope2&#34; }
                },
            };
    }
}
</code></pre><p>The <code>Config.cs</code> file contains a static class called <code>Config</code> that defines three static properties: <code>IdentityResources</code>, <code>ApiScopes</code>, and <code>Clients</code>. Each property returns an array of objects representing the available identity resources, API scopes, and clients, respectively.</p><p>The <code>IdentityResources</code> property defines the available identity resources. The <code>ApiScopes</code> property defines the available API scopes.</p><p>The <code>Clients</code> property defines the available client applications.</p><p><kbd>TestUsers.cs</kbd></p><pre tabindex=0><code>// Copyright (c) Duende Software. All rights reserved.
// See LICENSE in the project root for license information.

using Duende.IdentityServer;
using Duende.IdentityServer.Test;
using IdentityModel;
using System.Security.Claims;
using System.Text.Json;

namespace Microser.IdS
{
    public static class TestUsers
    {
        public static class Roles
        {
            public static string IdentityAdmin = &#34;IdentityAdmin&#34;;
            public static string Admin = &#34;Admin&#34;;
            public static string User = &#34;User&#34;;
        }

        public static List&lt;TestUser&gt; Users
        {
            get
            {
                var address = new
                {
                    street_address = &#34;One Hacker Way&#34;,
                    locality = &#34;Heidelberg&#34;,
                    postal_code = &#34;69118&#34;,
                    country = &#34;Germany&#34;
                };

                return new List&lt;TestUser&gt;
                {
                    new TestUser
                    {
                        SubjectId = &#34;1&#34;,
                        Username = &#34;alice&#34;,
                        Password = &#34;alice&#34;,
                        Claims =
                        {
                            new Claim(JwtClaimTypes.Name, &#34;Alice Smith&#34;),
                            new Claim(JwtClaimTypes.GivenName, &#34;Alice&#34;),
                            new Claim(JwtClaimTypes.FamilyName, &#34;Smith&#34;),
                            new Claim(JwtClaimTypes.Email, &#34;AliceSmith@email.com&#34;),
                            new Claim(JwtClaimTypes.EmailVerified, &#34;true&#34;, ClaimValueTypes.Boolean),
                            new Claim(JwtClaimTypes.WebSite, &#34;http://alice.com&#34;),
                            new Claim(JwtClaimTypes.Address, JsonSerializer.Serialize(address), IdentityServerConstants.ClaimValueTypes.Json),

                            new Claim(JwtClaimTypes.Role, Roles.IdentityAdmin),
                            new Claim(JwtClaimTypes.Role, Roles.Admin),
                            new Claim(JwtClaimTypes.Role, Roles.User)
                        }
                    },
                    new TestUser
                    {
                        SubjectId = &#34;2&#34;,
                        Username = &#34;bob&#34;,
                        Password = &#34;bob&#34;,
                        Claims =
                        {
                            new Claim(JwtClaimTypes.Name, &#34;Bob Smith&#34;),
                            new Claim(JwtClaimTypes.GivenName, &#34;Bob&#34;),
                            new Claim(JwtClaimTypes.FamilyName, &#34;Smith&#34;),
                            new Claim(JwtClaimTypes.Email, &#34;BobSmith@email.com&#34;),
                            new Claim(JwtClaimTypes.EmailVerified, &#34;true&#34;, ClaimValueTypes.Boolean),
                            new Claim(JwtClaimTypes.WebSite, &#34;http://bob.com&#34;),
                            new Claim(JwtClaimTypes.Address, JsonSerializer.Serialize(address), IdentityServerConstants.ClaimValueTypes.Json),

                            new Claim(JwtClaimTypes.Role, Roles.User)
                        }
                    }
                };
            }
        }
    }
}
</code></pre><p>The <code>TestUsers.cs</code> file contains a static class named <code>TestUsers</code> that defines test users and their associated <code>claims</code> and <code>roles</code>. The class also includes a nested class named <code>Roles</code> that defines some role constants.</p><h5 id=microserblazorappclient---blazor-web-app-project><strong>Microser.BlazorAppClient - Blazor Web App Project</strong></h5><p><kbd>Program.cs</kbd></p><pre tabindex=0><code>using Microser.BlazorAppClient;
using Microser.BlazorAppClient.Components;
using Microser.BlazorAppClient.HttpHandlers;
using Microser.BlazorAppClient.Services;
using Microsoft.AspNetCore.Authentication;
using Microsoft.AspNetCore.Authentication.Cookies;
using Microsoft.AspNetCore.Authentication.OpenIdConnect;
using Microsoft.IdentityModel.Tokens;
using Microsoft.Net.Http.Headers;

internal class Program
{
    private static void Main(string[] args)
    {
        var builder = WebApplication.CreateBuilder(args);

        // Add services to the container.
        builder.Services.AddRazorComponents()
            .AddInteractiveServerComponents();

        builder.Services.AddTransient&lt;AuthenticationDelegatingHandler&gt;();
        builder.Services.AddScoped&lt;IWeatherForecastApiService, WeatherForecastApiService&gt;();

        builder.Services.AddOIDCAuthentication();

        builder.Services.AddHttpClients();

        builder.Services.AddPolicies();

        builder.Services.AddHttpContextAccessor();

        var app = builder.Build();

        // Configure the HTTP request pipeline.
        if (!app.Environment.IsDevelopment())
        {
            app.UseExceptionHandler(&#34;/Error&#34;, createScopeForErrors: true);
            // The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.
            app.UseHsts();
        }

        app.UseHttpsRedirection();

        app.UseAuthentication();
        app.UseAuthorization();

        app.UseStaticFiles();
        app.UseAntiforgery();

        app.MapRazorComponents&lt;App&gt;()
            .AddInteractiveServerRenderMode();

        app.MapPost(&#34;/account/logout&#34;, async (HttpContext context) =&gt;
        {
            await context.SignOutAsync(CookieAuthenticationDefaults.AuthenticationScheme);
            await context.SignOutAsync(OpenIdConnectDefaults.AuthenticationScheme);
        });

        app.MapGet(&#34;/account/login&#34;, async (string redirectUri, HttpContext context) =&gt;
        {
            await context.ChallengeAsync(OpenIdConnectDefaults.AuthenticationScheme, new AuthenticationProperties { RedirectUri = redirectUri });
        });

        app.Run();
    }
}

public static class StartupExtensions
{
    public static void AddOIDCAuthentication(this IServiceCollection services)
    {
        services
            .AddAntiforgery(options =&gt; options.Cookie.Name = &#34;ClientBlazorAppAntiForgeryCookie&#34;)
            .AddAuthentication(options =&gt;
            {
                options.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;
                options.DefaultChallengeScheme = OpenIdConnectDefaults.AuthenticationScheme;
            })
        .AddCookie(options =&gt;
        {
            options.Cookie.Name = &#34;ClientBlazorAppAuthCookie&#34;;
            options.AccessDeniedPath = &#34;/AccessDenied&#34;;
        })
        .AddOpenIdConnect(OpenIdConnectDefaults.AuthenticationScheme, options =&gt;
        {
            options.Authority = &#34;https://localhost:5001/&#34;;
            options.ClientId = &#34;dotnet_blazor_serverapp&#34;;
            options.ClientSecret = &#34;E8C65E41BB0E4E519D409023CF5112F4&#34;;
            options.ResponseType = &#34;code&#34;;
            options.SaveTokens = true;
            options.GetClaimsFromUserInfoEndpoint = true;
            options.UseTokenLifetime = false;

            //options.SignedOutRedirectUri = &#34;/&#34;;

            options.Scope.Add(&#34;openid&#34;);
            options.Scope.Add(&#34;profile&#34;);
            options.Scope.Add(&#34;address&#34;);
            options.Scope.Add(&#34;email&#34;);
            options.Scope.Add(&#34;roles&#34;);

            options.Scope.Add(&#34;microser_api_weather&#34;);

            options.ClaimActions.MapJsonKey(&#34;role&#34;, &#34;role&#34;);
            //options.ClaimActions.MapUniqueJsonKey(&#34;role&#34;, &#34;role&#34;);
            //options.ClaimActions.MapAll();

            options.TokenValidationParameters = new
                TokenValidationParameters
            {
                NameClaimType = &#34;name&#34;,
                RoleClaimType = &#34;role&#34;
            };

            options.Events = new OpenIdConnectEvents
            {
                OnAccessDenied = context =&gt;
                {
                    context.HandleResponse();
                    context.Response.Redirect(&#34;/&#34;);
                    return Task.CompletedTask;
                }
            };
        });
    }

    public static void AddHttpClients(this IServiceCollection services)
    {
        services.AddHttpClient(&#34;WeatherForecastAPIClient&#34;, client =&gt;
        {
            client.BaseAddress = new Uri(&#34;https://localhost:6001/&#34;);
            client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add(HeaderNames.Accept, &#34;application/json&#34;);
        })
            .AddHttpMessageHandler&lt;AuthenticationDelegatingHandler&gt;();

        // added for get user info
        services.AddHttpClient(&#34;IDPClient&#34;, client =&gt;
        {
            client.BaseAddress = new Uri(&#34;https://localhost:5001/&#34;);
            client.DefaultRequestHeaders.Clear();
            client.DefaultRequestHeaders.Add(HeaderNames.Accept, &#34;application/json&#34;);
        });
    }

    public static void AddPolicies(this IServiceCollection services)
    {
        services.AddAuthorization(opts =&gt;
        {
            opts.AddPolicy(nameof(ProjectPolicies.UserRolePolicy), policy =&gt;
            {
                foreach (var role in ProjectPolicies.UserRolePolicy.RequiredRoles)
                    policy.RequireRole(role.RoleName);
            });
            opts.AddPolicy(nameof(ProjectPolicies.IdentityAdminRolePolicy), policy =&gt;
            {
                foreach (var role in ProjectPolicies.IdentityAdminRolePolicy.RequiredRoles)
                    policy.RequireRole(role.RoleName);
            });
            opts.AddPolicy(nameof(ProjectPolicies.AdminRolePolicy), policy =&gt;
            {
                foreach (var role in ProjectPolicies.AdminRolePolicy.RequiredRoles)
                    policy.RequireRole(role.RoleName);
            });
        });

        services.AddAuthorization(opts =&gt;
        {
            opts.AddPolicy(nameof(ProjectPolicies.WeatherForecastCreatePolicy), policy =&gt;
            {
                foreach (var claim in ProjectPolicies.WeatherForecastCreatePolicy.RequiredClaims)
                    policy.RequireClaim(claim.Type, new[] { claim.Value });
            });
            opts.AddPolicy(nameof(ProjectPolicies.WeatherForecastReadPolicy), policy =&gt;
            {
                foreach (var claim in ProjectPolicies.WeatherForecastReadPolicy.RequiredClaims)
                    policy.RequireClaim(claim.Type, new[] { claim.Value });
            });
            opts.AddPolicy(nameof(ProjectPolicies.WeatherForecastUpdatePolicy), policy =&gt;
            {
                foreach (var claim in ProjectPolicies.WeatherForecastUpdatePolicy.RequiredClaims)
                    policy.RequireClaim(claim.Type, new[] { claim.Value });
            });
            opts.AddPolicy(nameof(ProjectPolicies.WeatherForecastDeletePolicy), policy =&gt;
            {
                foreach (var claim in ProjectPolicies.WeatherForecastDeletePolicy.RequiredClaims)
                    policy.RequireClaim(claim.Type, new[] { claim.Value });
            });
        });
    }
}
</code></pre><p>The <code>Program.cs</code> contains the entry point of the application and the configuration of the HTTP request pipeline. It sets up the authentication and authorization middleware, handles static files, and defines routes for login and logout.</p><p>The <code>StartupExtensions</code> contains extension methods for configuring authentication, HTTP clients, and authorization policies. It sets up the OpenID Connect authentication scheme, configures the Identity Server endpoints, and defines the required scopes and claims.</p><p><kbd>WeatherForecastApiService.cs</kbd></p><pre tabindex=0><code>using Microser.BlazorAppClient.Extensions;
using Microser.Core.Models;

namespace Microser.BlazorAppClient.Services;

public class WeatherForecastApiService : IWeatherForecastApiService
{
    private readonly IHttpClientFactory _httpClientFactory;
    private readonly IHttpContextAccessor _httpContextAccessor;

    public WeatherForecastApiService(IHttpClientFactory httpClientFactory, IHttpContextAccessor httpContextAccessor)
    {
        _httpClientFactory = httpClientFactory ?? throw new ArgumentNullException(nameof(httpClientFactory));
        _httpContextAccessor = httpContextAccessor ?? throw new ArgumentNullException(nameof(httpContextAccessor));
    }

    public async Task&lt;WeatherForecast[]?&gt; GetAllAsync()
    {
        var httpClient = _httpClientFactory.CreateClient(&#34;WeatherForecastAPIClient&#34;);
        var request = new HttpRequestMessage(
            HttpMethod.Get,
            &#34;/WeatherForecast&#34;);
        var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead)
            .ConfigureAwait(false);
        response.EnsureSuccessStatusCode();

        //var content = await response.Content.ReadAsStringAsync();
        //var weatherForecastList = JsonSerializer.Deserialize&lt;List&lt;WeatherForecast&gt;&gt;(content);

        var weatherForecastList = await response.ReadContentAs&lt;WeatherForecast[]&gt;();
        return weatherForecastList;

    }

    public async Task&lt;WeatherForecast?&gt; GetByIdAsync(int id)
    {
        var httpClient = _httpClientFactory.CreateClient(&#34;WeatherForecastAPIClient&#34;);
        var request = new HttpRequestMessage(
            HttpMethod.Get,
            &#34;/WeatherForecast/&#34; + id);
        var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead)
            .ConfigureAwait(false);
        response.EnsureSuccessStatusCode();
        var item = await response.ReadContentAs&lt;WeatherForecast&gt;();
        return item;
    }

    public async Task&lt;WeatherForecast?&gt; AddAsync(WeatherForecast weatherForecast)
    {
        var httpClient = _httpClientFactory.CreateClient(&#34;WeatherForecastAPIClient&#34;);
        var request = new HttpRequestMessage(
            HttpMethod.Post, &#34;/WeatherForecast&#34;)
        {
            Content = JsonContent.Create(weatherForecast)
        };

        var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead)
            .ConfigureAwait(false);
        response.EnsureSuccessStatusCode();

        weatherForecast = await response.ReadContentAs&lt;WeatherForecast&gt;();
        return weatherForecast;
    }

    public async Task&lt;bool&gt; DeleteByIdAsync(int id)
    {
        var httpClient = _httpClientFactory.CreateClient(&#34;WeatherForecastAPIClient&#34;);
        var request = new HttpRequestMessage(
            HttpMethod.Delete, &#34;/WeatherForecast/&#34; + id.ToString());

        try
        {
            var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead)
            .ConfigureAwait(false);
            response.EnsureSuccessStatusCode();
        }
        catch (Exception)
        {
            return false;
        }

        return true;
    }

    public async Task&lt;bool&gt; UpdateAsync(int id, WeatherForecast weatherForecast)
    {
        var httpClient = _httpClientFactory.CreateClient(&#34;WeatherForecastAPIClient&#34;);
        var request = new HttpRequestMessage(
            HttpMethod.Put, &#34;/WeatherForecast/&#34; + weatherForecast.Id.ToString())
        {
            Content = JsonContent.Create(weatherForecast)
        };

        try
        {
            var response = await httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead)
            .ConfigureAwait(false);
            response.EnsureSuccessStatusCode();
        }
        catch (Exception)
        {
            return false;
        }
        return true;
    }
}
</code></pre><p>The <code>WeatherForecastApiService</code> class in the Blazor .NET 8 Microservices Blazor Client project provides methods to interact with a weather forecast API. It allows for retrieving, adding, updating, and deleting weather forecasts using HTTP requests. By utilizing the IHttpClientFactory and IHttpContextAccessor, it ensures efficient and secure communication with the API.</p><h4 id=source><strong>Source</strong></h4><p>Full source code is available at this repository in GitHub:<br><a href=https://github.com/akifmt/DotNetCoding/tree/main/src/Microser target=_blank rel=noopener>https://github.com/akifmt/DotNetCoding/tree/main/src/Microser</a></p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f&text=Blazor%20.NET%208%20Microservices%20Blazor%20Client%20and%20Securing%20API%20with%20Duende%20Identity%20Server&via=akifmt" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f&title=Blazor%20.NET%208%20Microservices%20Blazor%20Client%20and%20Securing%20API%20with%20Duende%20Identity%20Server" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f&title=Blazor%20.NET%208%20Microservices%20Blazor%20Client%20and%20Securing%20API%20with%20Duende%20Identity%20Server" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Blazor%20.NET%208%20Microservices%20Blazor%20Client%20and%20Securing%20API%20with%20Duende%20Identity%20Server https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Blazor%20.NET%208%20Microservices%20Blazor%20Client%20and%20Securing%20API%20with%20Duende%20Identity%20Server&body=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/akifmt/akifmt.github.io/edit/main/content/dotnet/2024-03-15-Blazor-.NET8-Microservices-Blazor-Client-and-Securing-API-with-Duende-Identity-Server/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn data-toggle=tooltip data-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#blazor-net-8-microservices-blazor-client-and-securing-api-with-duende-identity-server><strong>Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</strong></a><ul><li><a href=#projects><strong>Projects</strong></a></li><li><a href=#test-users><strong>Test Users</strong></a></li><li><a href=#microserapiweather---web-api-project><strong>Microser.API.Weather - Web API Project</strong></a></li><li><a href=#microserids---identityserver-project><strong>Microser.IdS - IdentityServer Project</strong></a></li><li><a href=#microserblazorappclient---blazor-web-app-project><strong>Microser.BlazorAppClient - Blazor Web App Project</strong></a></li></ul></li><li><a href=#source><strong>Source</strong></a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#recent-posts-dotnet>Recent Dotnet Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=/dotnet/>dotnet Blog</a></li><li class=nav-item><a class=smooth-scroll href=/contacts/contact/>Contact</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:akifmt@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>akifmt@gmail.com</span></a></li><li><a href=https://github.com/akifmt target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>akifmt</span></a></li></ul></div><div class="col-md-4 col-sm-12"><p>Stay up to date with email notification</p><form action="https://gmail.us17.list-manage.com/subscribe/post?u=9837d83f08f2fe6e2cefb8773&amp;amp;id=00c15e4346&amp;amp;f_id=00cac2e1f0" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div class=form-group><input type=email class=form-control id=mce-EMAIL name=EMAIL aria-describedby=emailHelp placeholder="Enter email">
<small id=emailHelp class="form-text text-muted">By entering your email address, you agree to receive the newsletter of this website.</small></div><button type=submit class="btn btn-info">Submit</button></form></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2016-2025 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.7ea48cac5c9f1f98d1499846cebb90d41a48f06232569cf86b20c6898114032f.js integrity="sha256-fqSMrFyfH5jRSZhGzruQ1BpI8GIyVpz4ayDGiYEUAy8=" defer></script><style>#consent-notice{padding:1rem;display:none;text-align:center;position:fixed;bottom:0;width:calc(100%);background:#222;color:rgba(255,255,255,.8)}#consent-notice span{margin-right:1rem}#consent-notice button{cursor:pointer;display:inline-block;width:auto}#consent-notice span a{color:inherit;text-decoration:underline;text-decoration-color:rgba(255,255,255,.5)}#consent-notice button.btn{margin-left:.5rem}#consent-notice button.btn.manage-consent{font-weight:400}#consent-overlay{position:fixed;left:0;top:0;width:100%;height:100vh;display:none;background:rgba(0,0,0,.75);z-index:999999;overflow:auto;cursor:pointer}#consent-overlay.active{display:flex}#consent-overlay>div{background:#fff;width:100%;max-width:30rem;padding:1.75rem;margin:auto;cursor:initial}#consent-overlay>div>div{display:flex;align-items:flex-start;margin-bottom:0}#consent-overlay>div>div:last-child{margin:0}#consent-overlay h3{padding-top:0}#consent-overlay input{margin-top:.3rem;margin-right:.3rem}#consent-overlay label{display:block}#consent-overlay .btn{margin-right:.5rem}#consent-overlay button.btn.save-consent{font-weight:400}@media(max-width:767px){#consent-overlay>div{padding:1.75rem 1rem}#consent-notice span{display:block;padding-top:3px;margin-bottom:1.5rem}#consent-notice button.btn{position:relative;bottom:4px}}</style><div id=consent-notice style=z-index:99><span>We would like to use <a class=manage-consent href=#manage-consent>third party code</a> to improve the functionality of this website.</span><button class="btn btn-outline-info manage-consent">Manage preferences</button><button class="btn btn-outline-danger deny-consent">Deny</button><button class="btn btn-outline-success approve-consent">Allow</button></div><div id=consent-overlay><div class=rounded style=background:#222><div><input type=checkbox id=item0 value=1 name=item0 checked disabled>
<label for=item0><h3 style=color:#f1f5f9;font-size:1.25rem>Google Anaytics (functional)</h3><p style=color:#cbd5e1;font-size:.9rem>This code gives us insight into the number of people that visit our website, where they are from and what they are clicking on.</p></label></div><div><input type=checkbox id=item1 value=1 name=item1>
<label for=item1><h3 style=color:#f1f5f9;font-size:1.25rem>Test</h3><p style=color:#cbd5e1;font-size:.9rem>Test.</p></label></div><div><button id=save-consent class="btn btn-outline-info save-consent" data-consentvalue=0>Save preferences</button>
<button class="btn btn-outline-success approve-consent">Allow all</button></div></div></div><script>const scripts=[];scripts[0]="/js/scriptAAA.js";function createCookie(e,t,n){var s,o="";n&&(s=new Date,s.setTime(s.getTime()+n*24*60*60*1e3),o="; expires="+s.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t,s=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(t=o[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(s)==0)return t.substring(s.length,t.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}function denyAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"0"}),acceptSomeConsentScripts(e)}function acceptAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"1"}),acceptSomeConsentScripts(e),gtag("consent","update",{ad_user_data:"granted",ad_personalization:"granted",ad_storage:"granted",analytics_storage:"granted"})}function acceptSomeConsentScripts(e){setConsentInputs(e),createCookie("consent-settings",e,31),document.getElementById("consent-notice").style.display="none",document.getElementById("consent-overlay").classList.remove("active"),loadConsentScripts(e)}function loadConsentScripts(e){scripts.forEach(function(t,n){if(e[n]=="1"){var s=document.createElement("script");s.type="text/javascript",s.src=t,document.body.appendChild(s)}})}function setConsentInputs(e){var t=document.querySelectorAll("#consent-overlay input:not([disabled])");t.forEach(function(t,n){e[n]=="1"?t.checked=!0:t.checked=!1})}function setConsentValue(){var t=document.querySelectorAll("#consent-overlay input:not([disabled])"),e="";t.forEach(function(t){t.checked?e=e+"1":e=e+"0"}),document.getElementById("save-consent").dataset.consentvalue=e}var elements=document.querySelectorAll("#consent-overlay input:not([disabled])"),consentValue;elements.forEach(function(e){e.checked=!1}),readCookie("consent-settings")?(consentValue=readCookie("consent-settings").toString(),setConsentInputs(consentValue),loadConsentScripts(consentValue)):document.getElementById("consent-notice").style.display="block",elements=document.querySelectorAll(".manage-consent"),elements.forEach(function(e){e.addEventListener("click",function(){document.getElementById("consent-overlay").classList.toggle("active")})}),elements=document.querySelectorAll(".deny-consent"),elements.forEach(function(e){e.addEventListener("click",function(){denyAllConsentScripts()})}),elements=document.querySelectorAll(".approve-consent"),elements.forEach(function(e){e.addEventListener("click",function(){acceptAllConsentScripts()})}),document.getElementById("save-consent").addEventListener("click",function(){setConsentValue(),acceptSomeConsentScripts(this.dataset.consentvalue)}),document.getElementById("consent-overlay").addEventListener("click",function(e){document.querySelector("#consent-overlay > div").contains(e.target)||this.classList.toggle("active")})</script><script type=text/javascript src=/js/ga.js></script></body></html>