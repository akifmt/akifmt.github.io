<!doctype html><html lang=en><head><title>Blazor Export Data to Word, Excel, PDF, CSV</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-S9QF79W9GM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S9QF79W9GM")</script><link rel=stylesheet href=/application.7e9b1ce61e96c97a25181a8082bc3655f4b78f877927f5d7df3d3c2902216d20.css integrity="sha256-fpsc5h6WyXolGBqAgrw2VfS3j4d5J/XX3z08KQIhbSA="><link rel=stylesheet href=/css/main_custom.css><link rel=icon type=image/png href=/images/site/favicon_hu5e0469842f323d92977e05301135eda0_41440_42x0_resize_box_3.png><meta property="og:url" content="https://akifmt.github.io/dotnet/2023-09-26-blazor-export-data-to-word-excel-pdf-csv/"><meta property="og:site_name" content="akifmt"><meta property="og:title" content="Blazor Export Data to Word, Excel, PDF, CSV"><meta property="og:description" content="Blazor Export Data to Word, Excel, PDF, CSV"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="dotnet"><meta property="article:published_time" content="2023-09-26T00:00:00+00:00"><meta property="article:modified_time" content="2023-09-26T00:00:00+00:00"><meta property="article:tag" content="Dotnet"><meta property="article:tag" content="Blazor Export Data to Word Excel PDF CSV"><meta name=twitter:card content="summary"><meta name=twitter:title content="Blazor Export Data to Word, Excel, PDF, CSV"><meta name=twitter:description content="Blazor Export Data to Word, Excel, PDF, CSV"><meta name=description content="Blazor Export Data to Word, Excel, PDF, CSV"><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-dotnet kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu9e97de834330d7f5d59d0d943d25df7c_18556_42x0_resize_box_3.png id=logo alt=Logo>
akifmt</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-toggle=collapse data-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#projects>Projects</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#recent-posts-dotnet>Recent Dotnet Posts</a>
<a class=dropdown-item href=/#recent-posts>Recent Posts</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link href=/dotnet/><img height=20 src=/images/dotnet-logo.png> dotnet Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu9e97de834330d7f5d59d0d943d25df7c_18556_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_huaeac6b74eff06a7b4d6b563d4aa0a06e_40468_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading>dotnet<a href=/dotnet/ data-filter=all></a></li><div class=subtree><li><a class=list-link href=/dotnet/2024-04-16-blazor-.net8-autocompile-sass-and-less/ title="Blazor .NET 8 Autocompile Sass and Less">Blazor .NET 8 Autocompile Sass and Less</a></li><li><a class=list-link href=/dotnet/2024-04-05-blazor-.net8-microservices-2-blazor-client-ocelot-gateway-and-securing-api-with-duende-identity-server/ title="Blazor .NET 8 Microservices 2 Blazor Client Ocelot Gateway and Securing API with Duende Identity Server">Blazor .NET 8 Microservices 2 Blazor Client Ocelot Gateway and Securing API with Duende Identity Server</a></li><li><a class=list-link href=/dotnet/2024-03-15-blazor-.net8-microservices-blazor-client-and-securing-api-with-duende-identity-server/ title="Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server">Blazor .NET 8 Microservices Blazor Client and Securing API with Duende Identity Server</a></li><li><a class=list-link href=/dotnet/2024-02-12-blazor-.net8-and-minimal-apis-native-aot-crud/ title="Blazor .NET 8 and Minimal APIs Native AOT CRUD">Blazor .NET 8 and Minimal APIs Native AOT CRUD</a></li><li><a class=list-link href=/dotnet/2024-02-09-blazor-.net8-object-mapping-with-automapper/ title="Blazor .NET 8 Object Mapping with AutoMapper">Blazor .NET 8 Object Mapping with AutoMapper</a></li><li><a class=list-link href=/dotnet/2024-01-24-blazor-.net8-object-mapping-with-mapster/ title="Blazor .NET 8 Object Mapping with Mapster">Blazor .NET 8 Object Mapping with Mapster</a></li><li><a class=list-link href=/dotnet/2024-01-20-blazor-.net8-migrating-app-from-.net-6-or-.net-7-to-.net-8/ title="Blazor .NET 8 Migrating app from .NET 6 or .NET 7 to .NET 8">Blazor .NET 8 Migrating app from .NET 6 or .NET 7 to .NET 8</a></li><li><a class=list-link href=/dotnet/2024-01-16-blazor-.net8-server-side-rendering-ssr/ title="Blazor .NET 8 Server-side Rendering (SSR)">Blazor .NET 8 Server-side Rendering (SSR)</a></li><li><a class=list-link href=/dotnet/2024-01-13-blazor-.net8-hosting-models/ title="Blazor .NET 8 Hosting Models">Blazor .NET 8 Hosting Models</a></li><li><a class=list-link href=/dotnet/2023-10-16-blazor-infinite-scrolling/ title="Blazor Infinite Scrolling">Blazor Infinite Scrolling</a></li><li><a class="active list-link" href=/dotnet/2023-09-26-blazor-export-data-to-word-excel-pdf-csv/ title="Blazor Export Data to Word, Excel, PDF, CSV">Blazor Export Data to Word, Excel, PDF, CSV</a></li><li><a class=list-link href=/dotnet/2023-09-21-blazor-external-login-identity-provider/ title="Blazor External Login Identity Provider Google, Facebook, Microsoft, Twitter">Blazor External Login Identity Provider Google, Facebook, Microsoft, Twitter</a></li><li><a class=list-link href=/dotnet/2023-09-10-blazor-radzen-loading-on-page/ title="Blazor Radzen Loading on Page">Blazor Radzen Loading on Page</a></li><li><a class=list-link href=/dotnet/2023-09-03-blazor-send-email-with-mailkit/ title="Blazor Send Email with MailKit">Blazor Send Email with MailKit</a></li><li><a class=list-link href=/dotnet/2023-08-30-blazor-redis-as-backplane/ title="Blazor Redis as Backplane">Blazor Redis as Backplane</a></li><li><a class=list-link href=/dotnet/2023-08-25-blazor-resize-and-upload-images/ title="Blazor Resize and Upload Images">Blazor Resize and Upload Images</a></li><li><a class=list-link href=/dotnet/2023-08-18-blazor-scheduling-with-quartz.net/ title="Blazor Scheduling with Quartz.NET">Blazor Scheduling with Quartz.NET</a></li><li><a class=list-link href=/dotnet/2023-08-15-blazor-serilog-logging/ title="Blazor Serilog Logging to Console, File and Database">Blazor Serilog Logging to Console, File and Database</a></li><li><a class=list-link href=/dotnet/2023-08-13-blazor-implementing-google-recaptcha-v2/ title="Blazor Implementing Google reCAPTCHA v2">Blazor Implementing Google reCAPTCHA v2</a></li><li><a class=list-link href=/dotnet/2023-08-11-blazor-implementing-google-recaptcha-v3/ title="Blazor Implementing Google reCAPTCHA v3">Blazor Implementing Google reCAPTCHA v3</a></li><li><a class=list-link href=/dotnet/2023-08-09-blazor-radzen-globalization-and-localization/ title="Blazor Radzen Globalization and Localization">Blazor Radzen Globalization and Localization</a></li><li><a class=list-link href=/dotnet/2023-08-07-blazor-using-npm-packages/ title="Blazor Using NPM Packages">Blazor Using NPM Packages</a></li><li><a class=list-link href=/dotnet/2023-08-05-blazor-generic-components/ title="Blazor Generic Components">Blazor Generic Components</a></li><li><a class=list-link href=/dotnet/2023-08-02-blazor-rssfeed/ title="Blazor Expose a Feed as RSS">Blazor Expose a Feed as RSS</a></li><li><a class=list-link href=/dotnet/2023-07-31-blazor-ef-multipledbproviders/ title="Blazor EF Migrations with Multiple Providers">Blazor EF Migrations with Multiple Providers</a></li><li><a class=list-link href=/dotnet/2023-07-30-blazor-authentication-authorization/ title="Blazor Authentication and Authorization">Blazor Authentication and Authorization</a></li><li><a class=list-link href=/dotnet/2023-07-26-blazor-radzen-crud/ title="Blazor Radzen CRUD">Blazor Radzen CRUD</a></li><li><a class=list-link href=/dotnet/2023-07-21-blazor-radzen-searchcomponent/ title="Blazor Radzen SearchComponent">Blazor Radzen SearchComponent</a></li><li><a class=list-link href=/dotnet/2023-07-20-blazor-plyr-video-player/ title="Blazor Plyr Video Player">Blazor Plyr Video Player</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/dotnet/2023-09-26-blazor-export-data-to-word-excel-pdf-csv/blazor_dotnet.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/akif_hu0b098ee5eab0ebaed64b2691fffe1073_4640_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Akif T.</h5><p class=text-muted>Tuesday, September 26, 2023 | 11 minutes</p></div><div class=title><h1>Blazor Export Data to Word, Excel, PDF, CSV</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/dotnet/ class="btn btn-sm btn-info">Dotnet</a></li><li class=rounded><a href=/tags/blazor-export-data-to-word-excel-pdf-csv/ class="btn btn-sm btn-info">Blazor Export Data to Word Excel PDF CSV</a></li></ul></div><div class=post-content id=post-content><p class="d-flex justify-content-center"><img src=blazor_dotnet.jpg alt=blazor_dotnet title=blazor_dotnet style=border-radius:20px><br><p><h4 id=blazor-export-data-to-word-excel-pdf-csv><strong>Blazor Export Data to Word, Excel, PDF, CSV</strong></h4><p>We will explore how to export data to various file formats such as Word, Excel, PDF, and CSV using Blazor, a web framework for building interactive user interfaces.</p><p>Blazor: Blazor is a web framework that allows developers to build interactive web applications using C# instead of JavaScript. It enables the creation of rich UI components and provides a seamless integration between the client and server.</p><p>Exporting Data: Exporting data refers to the process of converting data from one format to another, such as exporting data from a web application to a file format like Word, Excel, PDF, or CSV. This allows users to save or share the data in a more convenient and portable manner.</p><p>PdfSharp: PdfSharp is a popular open-source library for creating and manipulating PDF documents in C#. It provides a comprehensive set of features for generating PDF files, including text formatting, images, tables, and more.</p><p>FileFontResolver: The FileFontResolver class is a custom implementation of the IFontResolver interface provided by PdfSharp. It is responsible for resolving font information when exporting data to PDF. It maps font names to the corresponding font files in the application&rsquo;s file system.</p><h5 id=programcs><strong>Program.cs</strong></h5><pre tabindex=0><code>...
// add PdfSharp FontResolver
PdfSharp.Fonts.GlobalFontSettings.FontResolver = new FileFontResolver();
...
</code></pre><h5 id=filefontresolvercs><strong>FileFontResolver.cs</strong></h5><p>The <code>FileFontResolver</code> class implements the <code>IFontResolver</code> interface, which requires the implementation of two methods: <code>GetFont</code> and <code>ResolveTypeface</code>.</p><pre tabindex=0><code>using PdfSharp.Fonts;

namespace BlazorAppExport.Helpers;

public class FileFontResolver : IFontResolver
{
    public string DefaultFontName =&gt; throw new NotImplementedException();

    public byte[] GetFont(string faceName)
    {
        using (var ms = new MemoryStream())
        {
            using (var fs = File.Open(faceName, FileMode.Open))
            {
                fs.CopyTo(ms);
                ms.Position = 0;
                return ms.ToArray();
            }
        }
    }

    public FontResolverInfo ResolveTypeface(string familyName, bool isBold, bool isItalic)
    {
        if (familyName.Equals(&#34;Arial&#34;, StringComparison.CurrentCultureIgnoreCase))
        {
            if (isBold &amp;&amp; isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/arialbi.ttf&#34;);
            }
            else if (isBold)
            {
                return new FontResolverInfo(&#34;Fonts/arialbd.ttf&#34;);
            }
            else if (isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/ariali.ttf&#34;);
            }
            else
            {
                return new FontResolverInfo(&#34;Fonts/arial.ttf&#34;);
            }
        }
        if (familyName.Equals(&#34;Times New Roman&#34;, StringComparison.CurrentCultureIgnoreCase))
        {
            if (isBold &amp;&amp; isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/timesbi.ttf&#34;);
            }
            else if (isBold)
            {
                return new FontResolverInfo(&#34;Fonts/timesbd.ttf&#34;);
            }
            else if (isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/timesi.ttf&#34;);
            }
            else
            {
                return new FontResolverInfo(&#34;Fonts/times.ttf&#34;);
            }
        }
        if (familyName.Equals(&#34;Tahoma&#34;, StringComparison.CurrentCultureIgnoreCase))
        {
            if (isBold &amp;&amp; isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/tahoma.ttf&#34;);
            }
            else if (isBold)
            {
                return new FontResolverInfo(&#34;Fonts/tahomabd.ttf&#34;);
            }
            else if (isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/tahoma.ttf&#34;);
            }
            else
            {
                return new FontResolverInfo(&#34;Fonts/tahoma.ttf&#34;);
            }
        }
        if (familyName.Equals(&#34;Verdana&#34;, StringComparison.CurrentCultureIgnoreCase))
        {
            if (isBold &amp;&amp; isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/verdanaz.ttf&#34;);
            }
            else if (isBold)
            {
                return new FontResolverInfo(&#34;Fonts/verdanab.ttf&#34;);
            }
            else if (isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/verdanai.ttf&#34;);
            }
            else
            {
                return new FontResolverInfo(&#34;Fonts/verdana.ttf&#34;);
            }
        }
        if (familyName.Equals(&#34;Courier New&#34;, StringComparison.CurrentCultureIgnoreCase))
        {
            if (isBold &amp;&amp; isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/courbi.ttf&#34;);
            }
            else if (isBold)
            {
                return new FontResolverInfo(&#34;Fonts/courbd.ttf&#34;);
            }
            else if (isItalic)
            {
                return new FontResolverInfo(&#34;Fonts/couri.ttf&#34;);
            }
            else
            {
                return new FontResolverInfo(&#34;Fonts/cour.ttf&#34;);
            }
        }
        return null;
    }
}
</code></pre><p>The <code>GetFont</code> method is responsible for retrieving the <code>font data</code> based on the provided faceName. It uses the <code>File.Open</code> method to open the font file and then copies its contents to a <code>MemoryStream</code>. Finally, it returns the<code>byte array</code> representation of the font data.</p><p>The <code>ResolveTypeface</code> method is responsible for resolving the font information based on the provided <code>familyName, isBold, and isItalic</code> parameters. It checks the <code>familyName</code> against a set of predefined font names and returns the corresponding <code>FontResolverInfo</code> object.</p><h5 id=migradocdocumenthelpercs><strong>MigraDocDocumentHelper.cs</strong></h5><p>The code provided includes a <code>MigraDocDocumentHelper</code> class, which contains a static method <code>CreateDocument</code>. This method takes two parameters: <code>headerColumnNames and dataColumns</code>. It also has an optional parameter <code>dataSplitChar</code>, which defaults to <code>'|'</code>.</p><pre tabindex=0><code>using MigraDoc.DocumentObjectModel;
using MigraDoc.DocumentObjectModel.Shapes.Charts;
using MigraDoc.DocumentObjectModel.Tables;

namespace BlazorAppExport.Data;

public class MigraDocDocumentHelper
{
    public static Document CreateDocument(List&lt;string&gt; headerColumnNames, List&lt;string&gt; dataColumns, char dataSplitChar = &#39;|&#39;)
    {
        //GlobalFontSettings.FontResolver = new FileFontResolver();

        // Create a new MigraDoc document
        Document document = new Document();
        document.Info.Title = &#34;title&#34;;
        document.Info.Subject = &#34;subject&#34;;
        document.Info.Author = &#34;author&#34;;

        MigraDocStylesHelper.DefineStyles(document);

        MigraDocCoverHelper.DefineCover(document);
        MigraDocTableOfContentsHelper.DefineTableOfContents(document);

        MigraDocContentSectionHelper.DefineContentSection(document);

        //MigraDocParagraphsHelper.DefineParagraphs(document);
        //MigraDocTablesHelper.DefineTables(document);
        //MigraDocChartsHelper.DefineCharts(document);

        MigraDocTablesExportedDataHelper.DefineTablesExportedData(document, headerColumnNames, dataColumns, dataSplitChar);

        return document;
    }
}
</code></pre><p>The <code>CreateDocument</code> method is responsible for creating a new <code>MigraDoc</code> document and setting its <code>title, subject, and author</code>. It then calls various helper methods to define the document&rsquo;s <code>styles</code>, <code>cover page</code>, <code>table of contents</code>, <code>content section</code>, and <code>exported data tables</code>.</p><p>The <code>MigraDocTablesExportedDataHelper.DefineTablesExportedData</code> method is responsible for creating tables in the document and populating them with the provided header column names and data columns. The <code>dataSplitChar</code> parameter is used to split the data columns into individual values.</p><h5 id=exportcontrollercs><strong>ExportController.cs</strong></h5><p><code>ExportController</code> class demonstrates how to export data to a CSV, Excel, Pdf, Word file. This method takes an IQueryable query and an optional fileName parameter. It retrieves the properties of the query&rsquo;s element type and iterates over each item in the query. For each item, it retrieves the values of the properties and appends them to a StringBuilder object.</p><pre tabindex=0><code>public FileStreamResult ToCSV(IQueryable query, string? fileName = null)
{
	var columns = GetProperties(query.ElementType);

	var sb = new StringBuilder();

	foreach (var item in query)
	{
		var row = new List&lt;string&gt;();

		foreach (var column in columns)
		{
			row.Add($&#34;{GetValue(item, column.Key)}&#34;.Trim());
		}

		sb.AppendLine(string.Join(&#34;,&#34;, row.ToArray()));
	}

	var result = new FileStreamResult(new MemoryStream(UTF8Encoding.Default.GetBytes($&#34;{string.Join(&#34;,&#34;, columns.Select(c =&gt; c.Key))}{System.Environment.NewLine}{sb.ToString()}&#34;)), &#34;text/csv&#34;);
	result.FileDownloadName = (!string.IsNullOrEmpty(fileName) ? fileName : &#34;Export&#34;) + &#34;.csv&#34;;

	return result;
}

public FileStreamResult ToExcel(IQueryable query, string? fileName = null)
{
	var columns = GetProperties(query.ElementType);
	var stream = new MemoryStream();

	using (var document = SpreadsheetDocument.Create(stream, SpreadsheetDocumentType.Workbook))
	{
		var workbookPart = document.AddWorkbookPart();
		workbookPart.Workbook = new Workbook();

		var worksheetPart = workbookPart.AddNewPart&lt;WorksheetPart&gt;();
		worksheetPart.Worksheet = new Worksheet();

		var workbookStylesPart = workbookPart.AddNewPart&lt;WorkbookStylesPart&gt;();
		GenerateWorkbookStylesPartContent(workbookStylesPart);

		var sheets = workbookPart.Workbook.AppendChild(new Sheets());
		var sheet = new Sheet() { Id = workbookPart.GetIdOfPart(worksheetPart), SheetId = 1, Name = &#34;Sheet1&#34; };
		sheets.Append(sheet);

		workbookPart.Workbook.Save();

		var sheetData = worksheetPart.Worksheet.AppendChild(new SheetData());

		var headerRow = new Row();

		foreach (var column in columns)
		{
			headerRow.Append(new Cell()
			{
				CellValue = new CellValue(column.Key),
				DataType = new EnumValue&lt;CellValues&gt;(CellValues.String)
			});
		}

		sheetData.AppendChild(headerRow);

		foreach (var item in query)
		{
			var row = new Row();

			foreach (var column in columns)
			{
				var value = GetValue(item, column.Key);
				var stringValue = $&#34;{value}&#34;.Trim();

				var cell = new Cell();

				var underlyingType = column.Value.IsGenericType &amp;&amp;
					column.Value.GetGenericTypeDefinition() == typeof(Nullable&lt;&gt;) ?
					Nullable.GetUnderlyingType(column.Value) : column.Value;

				var typeCode = Type.GetTypeCode(underlyingType);

				if (typeCode == TypeCode.DateTime)
				{
					if (!string.IsNullOrWhiteSpace(stringValue))
					{
						cell.CellValue = new CellValue() { Text = ((DateTime)value).ToOADate().ToString(System.Globalization.CultureInfo.InvariantCulture) };
						cell.DataType = new EnumValue&lt;CellValues&gt;(CellValues.Number);
						cell.StyleIndex = (UInt32Value)1U;
					}
				}
				else if (typeCode == TypeCode.Boolean)
				{
					cell.CellValue = new CellValue(stringValue.ToLower());
					cell.DataType = new EnumValue&lt;CellValues&gt;(CellValues.Boolean);
				}
				else if (IsNumeric(typeCode))
				{
					if (value != null)
					{
						stringValue = Convert.ToString(value, CultureInfo.InvariantCulture);
					}
					cell.CellValue = new CellValue(stringValue);
					cell.DataType = new EnumValue&lt;CellValues&gt;(CellValues.Number);
				}
				else
				{
					cell.CellValue = new CellValue(stringValue);
					cell.DataType = new EnumValue&lt;CellValues&gt;(CellValues.String);
				}

				row.Append(cell);
			}

			sheetData.AppendChild(row);
		}

		workbookPart.Workbook.Save();
	}

	if (stream?.Length &gt; 0)
	{
		stream.Seek(0, SeekOrigin.Begin);
	}

	var result = new FileStreamResult(stream, &#34;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#34;);
	result.FileDownloadName = (!string.IsNullOrEmpty(fileName) ? fileName : &#34;Export&#34;) + &#34;.xlsx&#34;;

	return result;
}

public FileStreamResult ToPdf(IQueryable query, string? fileName = null)
{
	var columns = GetProperties(query.ElementType);
	List&lt;string&gt; headerColumns = new List&lt;string&gt;();
	foreach (var column in columns)
	{
		headerColumns.Add(column.Key);
	}

	char seperaterChar = &#39;|&#39;;
	List&lt;string&gt; dataColumns = new List&lt;string&gt;();
	foreach (var item in query)
	{
		List&lt;string&gt; lineData = new List&lt;string&gt;();
		foreach (var column in columns)
		{
			lineData.Add($&#34;{GetValue(item, column.Key)}&#34;.Trim());
		}
		string lineString = string.Join(seperaterChar, lineData);
		dataColumns.Add(lineString);
	}

	var stream = new MemoryStream();

	MigraDoc.DocumentObjectModel.Document doc = MigraDocDocumentHelper.CreateDocument(headerColumns, dataColumns, seperaterChar);
	MigraDoc.Rendering.PdfDocumentRenderer renderer = new();
	renderer.Document = doc;
	renderer.RenderDocument();

	renderer.PdfDocument.Save(stream);

	if (stream?.Length &gt; 0)
	{
		stream.Seek(0, SeekOrigin.Begin);
	}

	FileStreamResult? result = new FileStreamResult(stream, &#34;application/pdf&#34;);
	result.FileDownloadName = &#34;Export&#34; + &#34;.pdf&#34;;

	return result;
}

public FileStreamResult ToWord(IQueryable query, string? fileName = null)
{
	var columns = GetProperties(query.ElementType);

	var sb = new StringBuilder();

	// titles
	sb.Append(&#34;&lt;table border=&#39;1&#39; cellpadding=&#39;5&#39; cellspacing=&#39;0&#39; style=&#39;border: 1px solid #ccc;font-family: Arial; font-size: 10pt;&#39;&gt;&#34;);
	sb.Append(&#34;&lt;tr&gt;&#34;);
	foreach (var column in columns)
	{
		sb.Append($&#34;&lt;th style=&#39;background-color: #B8DBFD;border: 1px solid #ccc&#39;&gt;{column.Key}&lt;/th&gt;&#34;);
	}
	sb.Append(&#34;&lt;/tr&gt;&#34;);

	// rows
	foreach (var item in query)
	{
		sb.Append(&#34;&lt;tr&gt;&#34;);

		//Append data.
		foreach (var column in columns)
		{
			sb.Append(&#34;&lt;td style=&#39;border: 1px solid #ccc&#39;&gt;&#34;);
			sb.Append(GetValue(item, column.Key));
			sb.Append(&#34;&lt;/td&gt;&#34;);
		}
		sb.Append(&#34;&lt;/tr&gt;&#34;);
	}
	sb.Append(&#34;&lt;/table&gt;&#34;);

	MemoryStream stream = new MemoryStream(Encoding.UTF8.GetBytes(sb.ToString()));

	if (stream?.Length &gt; 0)
	{
		stream.Seek(0, SeekOrigin.Begin);
	}

	FileStreamResult? result = new FileStreamResult(stream, &#34;application/vnd.ms-word&#34;);

	result.FileDownloadName = (!string.IsNullOrEmpty(fileName) ? fileName : &#34;Export&#34;) + &#34;.doc&#34;;
	return result;
}
</code></pre><p>A <code>FileStreamResult</code> is created with the <code>stream</code>. The <code>FileDownloadName</code> property is set to <code>"Export"</code>. The method returns the <code>FileStreamResult</code>, which will prompt the user to download the exported file.</p><h5 id=blogpostcontrollercs><strong>BlogPostController.cs</strong></h5><p>The <code>BlogPostController.cs</code> file is a partial class that extends the <code>ExportController</code> class. It contains several action methods that handle the export functionality for the <code>BlogPost</code> entity.</p><pre tabindex=0><code>using BlazorAppExport.Services;
using Microsoft.AspNetCore.Mvc;

namespace BlazorAppExport.Controllers;

public partial class BlogPostController : ExportController
{
    private BlogPostService _blogPostService;

    public BlogPostController(BlogPostService blogPostService)
    {
        this._blogPostService = blogPostService;
    }

    [HttpGet(&#34;/export/ApplicationDb/BlogPost/csv&#34;)]
    public async Task&lt;FileStreamResult&gt; ExportBlogPostToCSV()
    {
        var result = await _blogPostService.GetAllAsync();
        var query = result.AsQueryable();

        return ToCSV(ApplyQuery(query, Request.Query));
    }

    [HttpGet(&#34;/export/ApplicationDb/BlogPost/excel&#34;)]
    public async Task&lt;FileStreamResult&gt; ExportBlogPostToExcel()
    {
        var result = await _blogPostService.GetAllAsync();
        var query = result.AsQueryable();

        return ToExcel(ApplyQuery(query, Request.Query));
    }

    [HttpGet(&#34;/export/ApplicationDb/BlogPost/pdf&#34;)]
    public async Task&lt;FileStreamResult&gt; ExportBlogPostToPdf()
    {
        var result = await _blogPostService.GetAllAsync();
        var query = result.AsQueryable();

        return ToPdf(ApplyQuery(query, Request.Query));
    }

    [HttpGet(&#34;/export/ApplicationDb/BlogPost/word&#34;)]
    public async Task&lt;FileStreamResult&gt; ExportBlogPostToWord()
    {
        var result = await _blogPostService.GetAllAsync();
        var query = result.AsQueryable();

        return ToWord(ApplyQuery(query, Request.Query));
    }
}
</code></pre><p>The constructor of the <code>BlogPostController</code> class takes an instance of the <code>BlogPostService</code> class as a parameter. This service is responsible for retrieving the data to be exported.</p><p>The <code>BlogPostController</code> class includes the following action methods:</p><p>ExportBlogPostToCSV: This method exports the BlogPost data to a <code>CSV file format</code>. It retrieves the data using the <code>GetAllAsync</code> method of the <code>BlogPostService</code> class and applies any <code>query parameters</code> passed in the request. The <code>ToCSV</code> method converts the data to a <code>CSV file</code> and returns it as a <code>FileStreamResult</code>.</p><p>ExportBlogPostToExcel: This method exports the <code>BlogPost</code> data to an <code>Excel file</code> format. It follows a similar process as the <code>ExportBlogPostToCSV</code> method but converts the data to an <code>Excel file</code> using the <code>ToExcel</code> method.</p><p>ExportBlogPostToPdf: This method exports the <code>BlogPost</code> data to a <code>PDF file</code> format. It retrieves the data and converts it to a <code>PDF file</code> using the <code>ToPdf</code> method.</p><p>ExportBlogPostToWord: This method exports the <code>BlogPost</code> data to a <code>Word file</code> format. It retrieves the data and converts it to a <code>Word file</code> using the <code>ToWord</code> method.</p><h5 id=exportservicecs><strong>ExportService.cs</strong></h5><p>The <code>ExportService</code> class has a method called <code>Export</code> that takes three parameters: <code>table, type, and query</code>. The table parameter represents the name of the table from which the data is to be exported. The <code>type parameter</code> represents the file format in which the data should be exported (e.g., Word, Excel, Pdf, CSV). The query parameter is an optional parameter of type <code>IQueryCollection</code> that represents any additional <code>query parameters</code> that should be included in the export URL.</p><pre tabindex=0><code>using Microsoft.AspNetCore.Components;

namespace BlazorAppExport.Services;

public class ExportService
{
    private readonly NavigationManager navigationManager;

    public ExportService(NavigationManager navigationManager)
    {
        this.navigationManager = navigationManager;
    }

    // Dynamic Query
    public void Export(string table, string type, IQueryCollection? query = null)
    {
        var url = $&#34;/export/ApplicationDb/{table}/{type}&#34;;
        if (query is not null)
        {
            string queryString = string.Join(&#34;&amp;&#34;, query.Select(x =&gt; $&#34;{x.Key}={x.Value}&#34;));
            url += $&#34;?{queryString}&#34;;
        }

        navigationManager.NavigateTo(url, true);
    }

}
</code></pre><p>In this method, we construct the export URL based on the provided table and type parameters. If the <code>query parameter</code> is not null, we iterate over its key-value pairs and append them to the URL as query parameters. Finally, we use the <code>navigationManager</code> to navigate to the generated URL, which triggers the file download.</p><h5 id=indexrazor><strong>Index.razor</strong></h5><p>Index.razor, <code>export buttons</code> allow the user to export all <code>blog posts</code> in different file formats such as <code>Excel</code>, <code>CSV</code>, <code>PDF</code>, and <code>Word</code>.</p><pre tabindex=0><code>@page &#34;/BlogPost&#34;

&lt;PageTitle&gt;Index&lt;/PageTitle&gt;

&lt;h1&gt;Index&lt;/h1&gt;

&lt;p&gt;
    &lt;a href=&#34;/BlogPost/Create&#34;&gt;Create New&lt;/a&gt;
&lt;/p&gt;

&lt;p&gt;
    &lt;button class=&#34;btn btn-primary&#34; @onclick=&#34;@(args =&gt; Export(&#34;excel&#34;))&#34;&gt;Export All XLS&lt;/button&gt;
    &lt;button class=&#34;btn btn-primary&#34; @onclick=&#34;@(args =&gt; Export(&#34;csv&#34;))&#34;&gt;Export All CSV&lt;/button&gt;
    &lt;button class=&#34;btn btn-primary&#34; @onclick=&#34;@(args =&gt; Export(&#34;pdf&#34;))&#34;&gt;Export All PDF&lt;/button&gt;
    &lt;button class=&#34;btn btn-primary&#34; @onclick=&#34;@(args =&gt; Export(&#34;word&#34;))&#34;&gt;Export All DOC&lt;/button&gt;
&lt;/p&gt;

&lt;p&gt;
    &lt;button class=&#34;btn btn-primary&#34; @onclick=&#34;@(args =&gt; ExportCustom(&#34;excel&#34;))&#34;&gt;Export Custom Items XLS&lt;/button&gt;
&lt;/p&gt;

@if (blogPosts == null)
{
    &lt;p&gt;&lt;em&gt;Loading...&lt;/em&gt;&lt;/p&gt;
}
else
{
    &lt;table class=&#34;table&#34;&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;th&gt;@nameof(BlogPostViewModel.Id)&lt;/th&gt;
                &lt;th&gt;@nameof(BlogPostViewModel.Title)&lt;/th&gt;
                &lt;th&gt;@nameof(BlogPostViewModel.Content)&lt;/th&gt;
                &lt;th&gt;&lt;/th&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            @foreach (var blogpost in blogPosts)
            {
                &lt;tr&gt;
                    &lt;td&gt;@blogpost.Id&lt;/td&gt;
                    &lt;td&gt;@blogpost.Title&lt;/td&gt;
                    &lt;td&gt;@blogpost.Content&lt;/td&gt;
                    &lt;td&gt;
                        &lt;a href=&#34;/BlogPost/Details/@blogpost.Id&#34;&gt;Details&lt;/a&gt; |
                        &lt;a href=&#34;/BlogPost/Edit/@blogpost.Id&#34;&gt;Edit&lt;/a&gt; |
                        &lt;a href=&#34;/BlogPost/Delete/@blogpost.Id&#34;&gt;Delete&lt;/a&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            }
        &lt;/tbody&gt;
    &lt;/table&gt;
}

@code {
    private IEnumerable&lt;BlogPostViewModel&gt;? blogPosts;

    protected override async Task OnInitializedAsync()
    {
        if (blogPosts == null)
        {
            var result = await BlogPostService.GetAllAsync();
            blogPosts = Mapper.Map&lt;IEnumerable&lt;BlogPost&gt;, IEnumerable&lt;BlogPostViewModel&gt;&gt;(result);
        }
    }

    public void Export(string type)
    {
        ExportService.Export(&#34;BlogPost&#34;, type);
    }

    public void ExportCustom(string type)
    {
        // Dynamic Query
        Dictionary&lt;string, Microsoft.Extensions.Primitives.StringValues&gt; queryValues = new();
        //queryValues.Add(&#34;$expand&#34;, $&#34;{nameof(BlogPost.Title)},{nameof(BlogPost.Content)}&#34;);
        queryValues.Add(&#34;$filter&#34;, $&#34;{nameof(BlogPost.Title)}.Contains(\&#34;Introduction\&#34;)&#34;);
        queryValues.Add(&#34;$orderBy&#34;, $&#34;{nameof(BlogPost.Title)} desc&#34;);
        queryValues.Add(&#34;$skip&#34;, &#34;1&#34;);
        queryValues.Add(&#34;$top&#34;, &#34;2&#34;);
        queryValues.Add(&#34;$select&#34;, $&#34;{nameof(BlogPost.Title)},{nameof(BlogPost.Content)}&#34;);
        IQueryCollection query = new QueryCollection(queryValues);
        ExportService.Export(&#34;BlogPost&#34;, type, query);
    }

}
</code></pre><p>Export method, is called when the user clicks on one of the export buttons. It takes a <code>parameter</code>, type, which represents the <code>file format</code> to export (e.g., &ldquo;excel&rdquo;, &ldquo;csv&rdquo;, &ldquo;pdf&rdquo;, &ldquo;word&rdquo;). The <code>ExportService</code> class is responsible for exporting the data to the specified file format.</p><p>The <code>ExportCustom</code> method is called when the user clicks on the &ldquo;Export Custom Items XLS&rdquo; button. It demonstrates how to <code>export</code> a custom selection of blog posts based on specific criteria. In this example, the <code>queryValues</code> dictionary is used to define the <code>query parameters</code> such as filtering, ordering, skipping, and selecting specific fields. The <code>ExportService</code> class is then called to export the data to the specified file format using the <code>query</code> parameters.</p><p>Exporting data to different file formats can greatly enhance the usability and accessibility of your Blazor application. Whether it&rsquo;s generating reports, sharing data with others, or archiving information, the ability to export data in different formats is a valuable feature to have.</p><h4 id=source><strong>Source</strong></h4><p>Full source code is available at this repository in GitHub:<br><a href=https://github.com/akifmt/DotNetCoding/tree/main/src/BlazorAppExport target=_blank rel=noopener>https://github.com/akifmt/DotNetCoding/tree/main/src/BlazorAppExport</a></p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f&text=Blazor%20Export%20Data%20to%20Word%2c%20Excel%2c%20PDF%2c%20CSV&via=akifmt" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f&title=Blazor%20Export%20Data%20to%20Word%2c%20Excel%2c%20PDF%2c%20CSV" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f&title=Blazor%20Export%20Data%20to%20Word%2c%20Excel%2c%20PDF%2c%20CSV" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Blazor%20Export%20Data%20to%20Word%2c%20Excel%2c%20PDF%2c%20CSV https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Blazor%20Export%20Data%20to%20Word%2c%20Excel%2c%20PDF%2c%20CSV&body=https%3a%2f%2fakifmt.github.io%2fdotnet%2f2023-09-26-blazor-export-data-to-word-excel-pdf-csv%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/akifmt/akifmt.github.io/edit/main/content/dotnet/2023-09-26-Blazor-Export-Data-to-Word-Excel-PDF-CSV/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"></div><hr><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="akifmt",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div><a id=scroll-to-top class=btn data-toggle=tooltip data-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><ul><li><ul><li><a href=#blazor-export-data-to-word-excel-pdf-csv><strong>Blazor Export Data to Word, Excel, PDF, CSV</strong></a><ul><li><a href=#programcs><strong>Program.cs</strong></a></li><li><a href=#filefontresolvercs><strong>FileFontResolver.cs</strong></a></li><li><a href=#migradocdocumenthelpercs><strong>MigraDocDocumentHelper.cs</strong></a></li><li><a href=#exportcontrollercs><strong>ExportController.cs</strong></a></li><li><a href=#blogpostcontrollercs><strong>BlogPostController.cs</strong></a></li><li><a href=#exportservicecs><strong>ExportService.cs</strong></a></li><li><a href=#indexrazor><strong>Index.razor</strong></a></li></ul></li><li><a href=#source><strong>Source</strong></a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#recent-posts-dotnet>Recent Dotnet Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://akifmt.github.io/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:akifmt@gmail.com target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>akifmt@gmail.com</span></a></li><li><a href=https://github.com/akifmt target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>akifmt</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Â© 2024 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.2c48a1bed190f1ee06a57cb008becd33ce498578a7142859593e401c9831fc96.js integrity="sha256-LEihvtGQ8e4GpXywCL7NM85JhXinFChZWT5AHJgx/JY=" defer></script><style>#consent-notice{padding:1rem;display:none;text-align:center;position:fixed;bottom:0;width:calc(100%);background:#222;color:rgba(255,255,255,.8)}#consent-notice span{margin-right:1rem}#consent-notice button{cursor:pointer;display:inline-block;width:auto}#consent-notice span a{color:inherit;text-decoration:underline;text-decoration-color:rgba(255,255,255,.5)}#consent-notice button.btn{margin-left:.5rem}#consent-notice button.btn.manage-consent{font-weight:400}#consent-overlay{position:fixed;left:0;top:0;width:100%;height:100vh;display:none;background:rgba(0,0,0,.75);z-index:999999;overflow:auto;cursor:pointer}#consent-overlay.active{display:flex}#consent-overlay>div{background:#fff;width:100%;max-width:30rem;padding:1.75rem;margin:auto;cursor:initial}#consent-overlay>div>div{display:flex;align-items:flex-start;margin-bottom:0}#consent-overlay>div>div:last-child{margin:0}#consent-overlay h3{padding-top:0}#consent-overlay input{margin-top:.3rem;margin-right:.3rem}#consent-overlay label{display:block}#consent-overlay .btn{margin-right:.5rem}#consent-overlay button.btn.save-consent{font-weight:400}@media(max-width:767px){#consent-overlay>div{padding:1.75rem 1rem}#consent-notice span{display:block;padding-top:3px;margin-bottom:1.5rem}#consent-notice button.btn{position:relative;bottom:4px}}</style><div id=consent-notice style=z-index:99><span>We would like to use <a class=manage-consent href=#manage-consent>third party code</a> to improve the functionality of this website.</span><button class="btn btn-outline-info manage-consent">Manage preferences</button><button class="btn btn-outline-danger deny-consent">Deny</button><button class="btn btn-outline-success approve-consent">Allow</button></div><div id=consent-overlay><div class=rounded style=background:#222><div><input type=checkbox id=item0 value=1 name=item0 checked disabled>
<label for=item0><h3 style=color:#f1f5f9;font-size:1.25rem>Google Anaytics (functional)</h3><p style=color:#cbd5e1;font-size:.9rem>This code gives us insight into the number of people that visit our website, where they are from and what they are clicking on.</p></label></div><div><input type=checkbox id=item1 value=1 name=item1>
<label for=item1><h3 style=color:#f1f5f9;font-size:1.25rem>Test</h3><p style=color:#cbd5e1;font-size:.9rem>Test.</p></label></div><div><button id=save-consent class="btn btn-outline-info save-consent" data-consentvalue=0>Save preferences</button>
<button class="btn btn-outline-success approve-consent">Allow all</button></div></div></div><script>const scripts=[];scripts[0]="/js/scriptAAA.js";function createCookie(e,t,n){var s,o="";n&&(s=new Date,s.setTime(s.getTime()+n*24*60*60*1e3),o="; expires="+s.toUTCString()),document.cookie=e+"="+t+o+"; path=/"}function readCookie(e){for(var t,s=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(t=o[n];t.charAt(0)==" ";)t=t.substring(1,t.length);if(t.indexOf(s)==0)return t.substring(s.length,t.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}function denyAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"0"}),acceptSomeConsentScripts(e)}function acceptAllConsentScripts(){var e="";scripts.forEach(function(){e=e+"1"}),acceptSomeConsentScripts(e)}function acceptSomeConsentScripts(e){setConsentInputs(e),createCookie("consent-settings",e,31),document.getElementById("consent-notice").style.display="none",document.getElementById("consent-overlay").classList.remove("active"),loadConsentScripts(e)}function loadConsentScripts(e){scripts.forEach(function(t,n){if(e[n]=="1"){var s=document.createElement("script");s.type="text/javascript",s.src=t,document.body.appendChild(s)}})}function setConsentInputs(e){var t=document.querySelectorAll("#consent-overlay input:not([disabled])");t.forEach(function(t,n){e[n]=="1"?t.checked=!0:t.checked=!1})}function setConsentValue(){var t=document.querySelectorAll("#consent-overlay input:not([disabled])"),e="";t.forEach(function(t){t.checked?e=e+"1":e=e+"0"}),document.getElementById("save-consent").dataset.consentvalue=e}var consentValue,elements=document.querySelectorAll("#consent-overlay input:not([disabled])");elements.forEach(function(e){e.checked=!1}),readCookie("consent-settings")?(consentValue=readCookie("consent-settings").toString(),setConsentInputs(consentValue),loadConsentScripts(consentValue)):document.getElementById("consent-notice").style.display="block",elements=document.querySelectorAll(".manage-consent"),elements.forEach(function(e){e.addEventListener("click",function(){document.getElementById("consent-overlay").classList.toggle("active")})}),elements=document.querySelectorAll(".deny-consent"),elements.forEach(function(e){e.addEventListener("click",function(){denyAllConsentScripts()})}),elements=document.querySelectorAll(".approve-consent"),elements.forEach(function(e){e.addEventListener("click",function(){acceptAllConsentScripts()})}),document.getElementById("save-consent").addEventListener("click",function(){setConsentValue(),acceptSomeConsentScripts(this.dataset.consentvalue)}),document.getElementById("consent-overlay").addEventListener("click",function(e){document.querySelector("#consent-overlay > div").contains(e.target)||this.classList.toggle("active")})</script><script type=text/javascript src=/js/ga.js></script></body></html>